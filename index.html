<!DOCTYPE html>
<html lang="pt-br">
<head>
  <!-- Mantenha seu head e estilos como está -->
</head>
<body>
  <h1>Agendamento da Consultoria</h1>
  <form id="customForm" onsubmit="validateAndRedirect(event)">
    <!-- Região primeiro -->
    <label for="region">Região:</label>
    <select id="region" required onchange="updateAvailableHours()">
      <option value="">Selecione uma região</option>
      <option value="Areia">Areia</option>
      <option value="Cabedelo">Cabedelo</option>
      <!-- ... mantenha todas as suas opções de região ... -->
      <option value="Soledade">Soledade</option>
      <option value="João Pessoa">João Pessoa</option>
      <option value="Patos">Patos</option>
    </select><br><br>

    <label for="date">Data:</label>
    <input type="date" id="date" required onclick="checkRegion()"><br><br>
    
    <label for="time">Horário:</label>
    <select id="time" required onclick="checkRegion()">
      <option value="">Selecione primeiro a região</option>
    </select><br><br>
    
    <button type="submit">Verificar Disponibilidade</button>
  </form>

  <!-- Mantenha sua caixa de diálogo como está -->
  <div class="overlay" id="overlay"></div>
  <div class="dialog" id="dialog">
    <div class="dialog-message" id="dialogMessage"></div>
    <button class="dialog-button" onclick="closeDialog()">Fechar</button>
  </div>

  <script>
    // Adicione estas novas funções
    function checkRegion() {
      const region = document.getElementById('region').value;
      const timeSelect = document.getElementById('time');
      const dateInput = document.getElementById('date');
      
      if (!region) {
        alert('Por favor, selecione primeiro a região.');
        timeSelect.value = '';
        dateInput.value = '';
        document.getElementById('region').focus();
        return false;
      }
      return true;
    }

    function updateAvailableHours() {
      const region = document.getElementById('region').value;
      const timeSelect = document.getElementById('time');
      const dateInput = document.getElementById('date');
      
      timeSelect.innerHTML = '<option value="">Selecione um horário</option>';
      
      if (!region) {
        timeSelect.innerHTML = '<option value="">Selecione primeiro a região</option>';
        timeSelect.value = '';
        dateInput.value = '';
        return;
      }
      
      const hours = region === 'Soledade' 
        ? ['13:00', '14:00', '15:00', '16:00', '17:00']
        : ['08:00', '09:00', '10:00', '11:00'];
      
      hours.forEach(hour => {
        const option = document.createElement('option');
        option.value = hour;
        option.textContent = hour;
        timeSelect.appendChild(option);
      });
    }

    // Adicione os eventos quando a página carregar
    document.addEventListener('DOMContentLoaded', function() {
      const timeSelect = document.getElementById('time');
      const dateInput = document.getElementById('date');
      
      timeSelect.addEventListener('mousedown', function(event) {
        if (!checkRegion()) {
          event.preventDefault();
        }
      });
      
      dateInput.addEventListener('mousedown', function(event) {
        if (!checkRegion()) {
          event.preventDefault();
        }
      });
      
      updateAvailableHours();
    });

    // Mantenha suas funções existentes
    async function validateAndRedirect(event) {
      // ... seu código existente ...
    }

    function showDialog(message) {
      // ... seu código existente ...
    }

    function closeDialog() {
      // ... seu código existente ...
    }
  </script>
</body>
</html>
